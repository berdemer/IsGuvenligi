# Keycloak Production Configuration
# Memory Optimization

# Database Connection Pool Settings
db-pool-initial-size=15
db-pool-min-size=10
db-pool-max-size=50
connection-pool-size=50

# Cache Configuration
cache-config-file=cluster.xml
cache-stack=tcp

# HTTP/HTTPS Configuration
http-enabled=true
http-port=8080
https-port=8443
hostname-strict=false

# Performance Tuning (Based on Keycloak 25.x best practices)
http-max-queued-requests=1000
http-pool-max-threads=200
proxy=edge

# Memory Management (Prevent progressive memory consumption)
cache-session-preloading=false
cache-online-user-sessions-max-count=5000
cache-offline-user-sessions-max-count=5000

# Password Hashing (Keycloak 25+ Argon2 optimization)
password-policy=hashAlgorithm(argon2)

# Memory & GC Settings (will be set via JAVA_OPTS)
# -Xms2048m -Xmx4096m -XX:+UseG1GC -XX:MaxGCPauseMillis=200

# Security & CORS
cors-enabled=true
cors-allow-origin=*
cors-allow-methods=GET,POST,PUT,DELETE,OPTIONS
cors-allow-headers=*

# Health Check Configuration
health-enabled=true
metrics-enabled=true

# Log Level
log-level=INFO